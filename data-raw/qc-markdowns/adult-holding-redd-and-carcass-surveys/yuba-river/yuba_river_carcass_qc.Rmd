---
title: "Yuba River Carcass QC"
author: "Maddee Rubenson (FlowWest)"
date: "`r Sys.Date()`"
output: rmarkdown::github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, fig.width=15, fig.height=10)
library(tidyverse)
library(lubridate)
library(googleCloudStorageR)
library(ggplot2)
library(scales)
library(readxl)

```

# Yuba River Carcass Data 

## Description of Monitoring Data

**Timeframe:** 

**Video Season:** 

**Completeness of Record throughout timeframe:** 

**Sampling Location:**

**Data Contact:** 

Any additional info?

## Access Cloud Data

```{r, eval=FALSE}
# Run Sys.setenv() to specify GCS_AUTH_FILE and GCS_DEFAULT_BUCKET before running 
# getwd() to see how to specify paths 
# Open object from google cloud storage
# Set your authentication using gcs_auth
gcs_auth(json_file = Sys.getenv('GCS_AUTH_FILE'))
gcs_global_bucket(bucket = Sys.getenv('GCS_DEFAULT_BUCKET'))

gcs_list_objects()
# git data and save as xlsx
gcs_get_object(object_name = "adult-holding-redd-and-carcass-surveys/yuba-river/data-raw/Carcass_datarequest07122022.xlsx",
               bucket = gcs_get_global_bucket(),
               saveToDisk = "raw_carcass_yuba_river.xlsx",
               overwrite = TRUE)

```

Read in data from google cloud, glimpse raw data and domain description sheet: 
```{r}
# read in data to clean 

sheets <- excel_sheets("raw_carcass_yuba_river.xlsx")
sheets 
raw_carcass_data <- read_excel("raw_carcass_yuba_river.xlsx", 
                               sheet = "Carcass") %>% glimpse()

```

## Data transformations

```{r}
# Snake case, 
# Columns are appropriate types
# Remove redundant columns

clean_yuba_carcass <- raw_carcass_data %>% janitor::clean_names() %>% 
  rename(river_mile = rm) %>%
  glimpse

summary(clean_yuba_carcass)
```

## Explore Numeric Variables: {.tabset}

```{r}
# Filter clean data to show only numeric variables 
```

### `river_mile`

**Plotting river_mile over Period of Record**

```{r}
summary(clean_yuba_carcass$river_mile)

ggplot() + 
  geom_histogram(data = clean_yuba_carcass, aes(river_mile))

```

### `fork_lengh`

```{r}

summary(clean_yuba_carcass$fork_length)

# histogram
ggplot() + 
  geom_histogram(data = clean_yuba_carcass, aes(fork_length))

# boxplot
ggplot() + 
  geom_boxplot(data = clean_yuba_carcass, aes(y = fork_length, x = spawned)) +
  geom_jitter(data = clean_yuba_carcass, aes(y = fork_length, x = spawned), alpha = 0.5)
```
## Explore Categorical variables: {.tabset}

General notes: If there is an opportunity to turn yes no into boolean do so, but not if you loose value 

```{r}
# Filter clean data to show only categorical variables
```

### `survey_id`

### `fresh`

### `adipose_clip`

### `sex`

### `spawned`

```{r}
#table() 
```

Fix inconsistencies with spelling, capitalization, and abbreviations. 

```{r}
# Fix any inconsistencies with categorical variables
```

**Create lookup rda for [variable] encoding:** 
```{r}
# Create named lookup vector
# Name rda [watershed]_[data type]_[variable_name].rda
# save rda to data/ 
```

**NA and Unknown Values**

Provide a stat on NA or unknown values

## Summary of identified issues

* List things that are funcky/bothering us but that we don't feel like should be changed without more investigation

## Save cleaned data back to google cloud 

```{r}
# Write to google cloud 
# Name file [watershed]_[data type].csv
```