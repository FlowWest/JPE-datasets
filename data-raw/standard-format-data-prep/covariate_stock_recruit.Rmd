---
title: "Covariate processing for stock recruit model"
output: html_document
date: "2023-12-21"
---

```{r setup, include=FALSE}
root.dir <- rprojroot::find_rstudio_root_file()
knitr::opts_knit$set(root.dir)
knitr::opts_chunk$set(echo = TRUE)
```

# Overview
Describe goal of document
Insert table of covariates and citations

# Temperature
Temperature has been found to influence spawning and rearing. Therefore it is expected to affect the translation from stock to recruit. Temperature can be included in multiple different formats including:
- Number of degree days
- Day of year when 7DADM drops below 13 C
- Maximum weekly stream temperature
- Emergence date (calculated from degree days and median spawning date)

TODO update this section with more information about sources if do literature review or add additional types

```{r, include=F}
# Temperature data pull
# 1. Review ~/data-raw/qc-markdowns/temperature_data_prep.Rmd
# 2. Source data prep
source(knitr::purl(here::here("data-raw", "qc-markdowns", "temperature_data_prep.Rmd"), quiet=TRUE)) # after reviewing we will likely just source the data prep file here so you have access to all the data objects

```

## Number of degree days
DD= ((Tmax + Tmin / 2) - T0), where Tmax and Tmin are daily ambient temps, and T0 is the base or threshold temp
Citation: Chezik, Kyle & Lester, Nigel & Venturelli, Paul. (2014). Fish growth and degree-days I: Selecting a base temperature for a within-population study. Canadian Journal of Fisheries and Aquatic Sciences. 71. 47-55. 10.1139/cjfas-2013-0295. 
```{r}
# We are stating with Butte data because its ok and would be a good placeholder
glimpse(BCK_daily_temps)
butte_dd <- BCK_daily_temps |> 
  mutate(month= month(date), 
         wyear= ifelse(month %in% (10:12), year(date)+1, year(date))) |>  
  filter(month>=11 | month<=4) |> 
  mutate(degdays= ((max_temp_degC + min_temp_degC) / 2) - 2) 
butte_dd_sum <- butte_dd |> 
  group_by(wyear) |> 
  summarise(totalddays=sum(degdays))
ggplot(butte_dd, aes(as.factor(wyear), degdays))+
  geom_boxplot()
ggplot(butte_dd_sum, aes(wyear, totalddays)) +
  geom_col()
?water_year_indices
```


## Day of year

## Max temperature

## Emergence date

# Flow
Precipitation and streamflow have been found to influence spawning and rearing. Therefore it is expected to affect the translation from stock to recruit. Streamflow can be included in multiple different formats including:
- Mean precipitation (or streamflow)
- Max monthly precipitation (or streamflow)

TODO update this section with more information about sources if do literature review or add additional types

```{r, include=F}
# Flow data pull
# 1. Review ~/data-raw/standard-format-data-prep/flow_data_prep_files/flow_data_prep.Rmd
# 2. Source data prep
# source(knitr::purl(here::here("data-raw", "standard-format-data-prep", "flow_data_prep_files", "flow_data_prep.Rmd"), quiet=TRUE)) # after reviewing we will likely just source the data prep file here so you have access to all the data objects
```


## Mean flow

## Max flow


