---
title: "RST trap locations"
author: "Erin Cain"
date: "4/21/2022"
output:
  html_document:
     code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, fig.width=15, fig.height=10)
library(leaflet)
library(scales)
library(tidyverse)
library(googleCloudStorageR)
```


## RST sites {.tabset}

There are 8 tributaries included in the SR JPE. All 8 of these tributaries have 
historically had or have ongoing RST monitoring programs. These 8 tributaries 
have one or more RST running at the following trap locations:


### Table of RST site 
```{r, message=FALSE}
rst_sites <- read_csv("../../analysis/exploratory-analysis/data/rst_sites.csv") %>% 
  select(-year) %>%
  distinct() %>% 
  arrange(tributary)
knitr::kable(rst_sites)
```

### Map of RST sites

```{r}
leaflet(rst_sites)  %>% 
  addProviderTiles(providers$Esri.WorldTopoMap, group = "Map") %>% 
  addCircleMarkers(data = rst_sites,  label = rst_sites$site_name, 
                   weight = 1.5, color = "blue",
                   opacity =  1, fillOpacity = .25, 
                   labelOptions = labelOptions(noHide = T, # Set to F to hide labels
                                               style = list("font-size" = "14px")), 
                   popup = paste(sep = "<br/>",
                                 rst_sites$sub_site_name,
                                 paste("River Mile:", rst_sites$river_mile),
                                 paste("RST Size:", rst_sites$rst_size),
                                 paste("RST Season:", rst_sites$trapping_season))
  ) %>%
  addScaleBar()

```

## Save RST_trap_locations.csv to google cloud 

```{r}
gcs_auth(json_file = Sys.getenv("GCS_AUTH_FILE"))
# Set global bucket 
gcs_global_bucket(bucket = Sys.getenv("GCS_DEFAULT_BUCKET"))

f <- function(input, output) write_csv(input, file = output)

gcs_upload(rst_sites,
           object_function = f,
           type = "csv",
           name = "standard-format-data/rst_trap_locations.csv")
```

