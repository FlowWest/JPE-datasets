---
title: "Feather River RST Trap Efficency Data QC"
author: "Erin Cain"
date: "9/29/2021"
output: rmarkdown::github_document
---
  
```{r setup, include=FALSE, fig.width=15, fig.height=10}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
library(tidyverse)
library(lubridate)
library(googleCloudStorageR)
library(ggplot2)
library(scales)
library(readxl)
```

# Feather River RST Catch Data

## Description of Monitoring Data

This data is trap efficency data that can be used in combination with feather river rst data. To combine join by date?...TODO check

**Timeframe:** Dec 1997 - May 2021

**Trapping Season:** Typically December - June, looks like it varies quite a bit. 

**Completeness of Record throughout timeframe:** There are trap efficiency measures for every year that we have RST catch data. 

**Data Contact:** 
[Kassie Hickey](mailto:KHickey@psmfc.org)

## Access Cloud Data

```{r, eval=FALSE}
# Run Sys.setenv() to specify GCS_AUTH_FILE and GCS_DEFAULT_BUCKET before running 
# getwd() to see how to specify paths 
# Open object from google cloud storage
# Set your authentication using gcs_auth
gcs_auth(json_file = Sys.getenv("GCS_AUTH_FILE"))
# Set global bucket 
gcs_global_bucket(bucket = Sys.getenv("GCS_DEFAULT_BUCKET"))

gcs_list_objects()
# git data and save as xlsx
gcs_get_object(object_name = "rst/feather-river/data-raw/Feather River RST Sampling Effort_1998-2021.xlsx",
               bucket = gcs_get_global_bucket(),
               saveToDisk = "raw_feather_rst_sampling_effort_data.xlsx",
               overwrite = TRUE)
```

Read in data from google cloud, glimpse raw data and domain description sheet: 
```{r}
# read in data to clean
# RST Data
rst_data_sheets <- readxl::excel_sheets("raw_feather_rst_sampling_effort_data.xlsx")
location_details  <- readxl::read_excel("raw_feather_rst_sampling_effort_data.xlsx", 
                                           sheet = "RST Location Details") 
location_details
# create function to read in all sheets of a 
read_sheets <- function(sheet){
  data <- read_excel("raw_feather_rst_sampling_effort_data.xlsx", sheet = sheet)
}

raw_efficency <- purrr::map(rst_data_sheets[-1], read_sheets) %>%
  reduce(bind_rows)

raw_efficency %>% glimpse()
```

## Data transformations

```{r}
# Snake case, 
# Columns are appropriate types
# Remove redundant columns
cleaner_efficency_data <- raw_efficency %>%


cleaner_efficency_data %>% glimpse()
```

## Explore Numeric Variables: {.tabset}

```{r}
# Filter clean data to show only numeric variables (this way we know we do not miss any)
```

### Variable: `[name]`

**Plotting [Variable] over Period of Record**
  
  ```{r}
# Make whatever plot is appropriate 
# maybe 2 plots is appropriate
```

**Numeric Summary of [Variable] over Period of Record**
  
  ```{r}
# Table with summary statistics
```

**NA and Unknown Values**
  
  Provide a stat on NA or unknown values

## Explore Categorical variables: {.tabset}

General notes: If there is an opertunity to turn yes no into boolean do so, but not if you loose value 


```{r}
# Filter clean data to show only categorical variables (this way we know we do not miss any)
```


### Variable: `[name]`
```{r}
# table() 
```

Fix inconsistencies with spelling, capitalization, and abbreviations. 

```{r}
# Fix any inconsistancies with catagorical variables
```

**Create lookup rda for [variable] encoding:** 
```{r}
# Create named lookup vector
# Name rda [watershed]_[data type]_[variable_name].rda
# save rda to data/ 
```

**NA and Unknown Values**
  
  Provide a stat on NA or unknown values

### Save cleaned data back to google cloud 

```{r}
# Write to google cloud 
# Name file [watershed]_[data type].csv
```
